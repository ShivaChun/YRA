<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Y/R/A  | 逸離建築/韻室設計</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, doc, getDocs, setDoc, deleteDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Initialize Firebase
        const firebaseConfig = JSON.parse(window.__firebase_config || '{}');
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = window.__app_id || 'default-app';
        
        // Init Function
        async function init() {
            try {
                if (window.__initial_auth_token) {
                    await signInWithCustomToken(auth, window.__initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (error) {
                console.error("Authentication Error:", error);
                // Fallback to static data if auth fails
                return; 
            }

            if (!auth.currentUser) return;
            
            // 1. Projects Listener
            const projectsRef = collection(db, 'artifacts', appId, 'public', 'data', 'projects');
            onSnapshot(projectsRef, async (snapshot) => {
                if (snapshot.empty) {
                    // Seed Data using the global initialProjects if DB is empty
                    if(window.initialProjects) {
                        console.log("Seeding initial data...");
                        for(let p of window.initialProjects) {
                            await setDoc(doc(projectsRef, p.id), p);
                        }
                    }
                } else {
                    // Update global data with DB data
                    const dbProjects = snapshot.docs.map(d => d.data()).sort((a,b) => parseInt(a.id) - parseInt(b.id));
                    window.projectsData = dbProjects; 
                    
                    // Refresh Views
                    if(window.renderFrontendProjects) window.renderFrontendProjects(window.projectsData);
                    if(window.refreshAdminProjects) window.refreshAdminProjects();
                    
                    // If "All Projects" overlay is open, refresh it
                    const overlay = document.getElementById('all-projects-overlay');
                    if(overlay && overlay.classList.contains('open') && window.openAllProjects) {
                        window.openAllProjects(); 
                    }
                }
            }, (err) => console.error("Projects sync error", err));

            // 2. Texts Listener
            const textsRef = collection(db, 'artifacts', appId, 'public', 'data', 'site_texts');
            onSnapshot(textsRef, async (snapshot) => {
                if (snapshot.empty) {
                    if(window.initialTexts) {
                        for(let [key, val] of Object.entries(window.initialTexts)) {
                            await setDoc(doc(textsRef, key), { content: val });
                        }
                    }
                } else {
                    const dbTexts = {};
                    snapshot.docs.forEach(d => { dbTexts[d.id] = d.data().content; });
                    window.siteTexts = dbTexts;
                    if(window.renderTexts) window.renderTexts();
                    if(window.refreshAdminTexts) window.refreshAdminTexts();
                }
            }, (err) => console.error("Texts sync error", err));
        }

        init();

        // Global functions for Admin interaction (Exposed to Window)
        window.saveProject = async (projectData) => {
            const projectsRef = collection(db, 'artifacts', appId, 'public', 'data', 'projects');
            await setDoc(doc(projectsRef, projectData.id), projectData);
            alert("作品已儲存！");
        };

        window.deleteProject = async (id) => {
            if(confirm("確定要刪除此作品嗎？")) {
                const projectsRef = collection(db, 'artifacts', appId, 'public', 'data', 'projects');
                await deleteDoc(doc(projectsRef, id));
                alert("作品已刪除");
            }
        };

        window.saveSiteText = async (key, content) => {
             const textsRef = collection(db, 'artifacts', appId, 'public', 'data', 'site_texts');
             await setDoc(doc(textsRef, key), { content: content });
             alert("文字已更新！");
        };
    </script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'yr-black': '#2E2E2E',
                        'yr-red': '#B85742',
                        'yr-white': '#F5F5F5',
                        'yr-green': '#5C8261',
                        'yr-grey': '#A0A0A0',
                    },
                    fontFamily: {
                        'sans': ['Inter', 'Noto Sans TC', 'sans-serif'],
                        'serif': ['Times New Roman', 'serif'],
                    },
                    fontSize: {
                        'fluid-xs': 'clamp(11px, 0.9vw, 15px)',    
                        'fluid-sm': 'clamp(13px, 1.1vw, 18px)',    
                        'fluid-base': 'clamp(15px, 1.4vw, 22px)', 
                        'fluid-lg': 'clamp(17px, 1.8vw, 26px)',    
                        'fluid-xl': 'clamp(22px, 2.5vw, 32px)',    
                        'fluid-2xl': 'clamp(28px, 3.5vw, 48px)',  
                    }
                }
            }
        }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #F5F5F5;
            color: #2E2E2E;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
            touch-action: manipulation;
        }
        .lang-section { display: none; opacity: 0; transition: opacity 0.8s ease-in-out; }
        .lang-section.active { display: block; opacity: 1; }
        .portal-fade-out { opacity: 0; pointer-events: none; transition: opacity 0.8s ease-in-out; }
        .portal-fade-in { opacity: 1; pointer-events: auto; transition: opacity 0.8s ease-in-out; }
        .animate-on-scroll { opacity: 0; transform: translateY(30px); transition: opacity 1.0s ease-out, transform 1.0s ease-out; }
        .animate-on-scroll.is-visible { opacity: 1; transform: translateY(0); }
        .logo-stroke { fill: none; stroke: currentColor; stroke-dasharray: 4000; stroke-dashoffset: 4000; animation: drawStroke 4s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate; }
        .logo-fill { fill: currentColor; opacity: 0.1; animation: fadeInFill 4s infinite alternate; }
        @keyframes drawStroke { 0% { stroke-dashoffset: 4000; opacity: 0.3; } 100% { stroke-dashoffset: 0; opacity: 1; } }
        @keyframes fadeInFill { 0% { opacity: 0; } 100% { opacity: 0.15; } }
        
        /* Portal Interactive */
        .portal-interactive-group { cursor: default; display: flex; align-items: center; justify-content: center; gap: 1vw; }
        .portal-letter { display: inline-block; transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), color 0.3s ease; }
        .portal-interactive-group:hover .portal-letter { color: #B85742; transform: translateY(-8px); }
        .portal-slash-svg line { stroke: #A0A0A0; stroke-width: 2; stroke-linecap: round; stroke-dasharray: 20; stroke-dashoffset: 20; animation: slashFlow 3s infinite ease-in-out; transition: stroke 0.3s ease; }
        .portal-interactive-group:hover .portal-slash-svg line { stroke: #B85742; }
        @keyframes slashFlow { 0% { stroke-dashoffset: 20; opacity: 0; } 20% { opacity: 1; } 40% { stroke-dashoffset: 0; } 60% { stroke-dashoffset: 0; } 100% { stroke-dashoffset: -20; opacity: 0; } }

        .hero-float { animation: floating 4s ease-in-out infinite; }
        @keyframes floating { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }

        .structure-svg-path { fill: none; stroke-width: 50; stroke-linecap: round; stroke-linejoin: round; stroke-dasharray: 5000; stroke-dashoffset: 5000; animation: drawStructure 2s ease-out forwards; }
        .structure-svg-fill { fill: #F5F5F5; opacity: 0; animation: fillStructure 1s ease-out 1.5s forwards; }
        @keyframes drawStructure { to { stroke-dashoffset: 0; } }
        @keyframes fillStructure { to { opacity: 1; } }

        .link-underline { position: relative; text-decoration: none; }
        .link-underline::after { content: ''; position: absolute; width: 0%; height: 1px; bottom: -4px; left: 0; background-color: #B85742; transition: width 0.4s ease-out; }
        .link-underline:hover::after { width: 100%; }

        .bg-grid-pattern { background-size: 40px 40px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0.03) 1px, transparent 1px), linear-gradient(to bottom, rgba(0, 0, 0, 0.03) 1px, transparent 1px); }
        .leader-reveal { max-height: 0; opacity: 0; overflow: hidden; transition: max-height 0.6s ease-out, opacity 0.6s ease-out; }
        .leader-reveal.show { max-height: 300px; opacity: 1; margin-top: 1.5vh; }

        #mobile-menu { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #F5F5F5; z-index: 40; transform: translateX(100%); transition: transform 0.5s cubic-bezier(0.77, 0, 0.175, 1); display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #mobile-menu.open { transform: translateX(0); }
        
        .hamburger-line { transition: all 0.3s ease-in-out; transform-origin: center; }
        .hamburger-active .line-1 { transform: translateY(7px) rotate(45deg); }
        .hamburger-active .line-2 { opacity: 0; }
        .hamburger-active .line-3 { transform: translateY(-7px) rotate(-45deg); }

        .overlay-fixed { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #F5F5F5; z-index: 60; overflow-y: auto; transform: translateY(100%); transition: transform 0.6s cubic-bezier(0.77, 0, 0.175, 1); }
        .overlay-fixed.open { transform: translateY(0); }
        .close-btn { position: absolute; top: 2rem; right: 2rem; z-index: 70; cursor: pointer; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; border: 1px solid #ddd; transition: all 0.3s ease; }
        .close-btn:hover { background-color: #B85742; border-color: #B85742; color: white; }
        .project-card:hover .project-img { transform: scale(1.05); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .fade-img { animation: fadeEffect 0.5s; }
        @keyframes fadeEffect { from {opacity: 0.4;} to {opacity: 1;} }

        #transition-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #F5F5F5; z-index: 80; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        #transition-overlay.active { opacity: 1; pointer-events: auto; }
        .trans-svg-path { fill: none; stroke: #2E2E2E; stroke-width: 40; stroke-linecap: round; stroke-linejoin: round; stroke-dasharray: 6000; stroke-dashoffset: 6000; }
        .trans-anim-active .trans-svg-path { animation: drawTransStroke 1.8s ease-in-out forwards; }
        @keyframes drawTransStroke { 0% { stroke-dashoffset: 6000; opacity: 0.5; } 100% { stroke-dashoffset: 0; opacity: 1; } }

        /* Admin UI Styles */
        .admin-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 100; justify-content: center; align-items: center; }
        .admin-modal.active { display: flex; }
        .dashboard-tab.active { border-bottom: 2px solid #B85742; color: #B85742; }
        
        :root { --section-padding-x: 4vw; }
    </style>
</head>
<body class="bg-yr-white text-yr-black selection:bg-yr-red selection:text-white">

    <!-- Portal -->
    <div id="portal" class="fixed inset-0 z-[100] bg-yr-white flex flex-col justify-center items-center overflow-hidden">
        <div id="portal-logo-container" class="w-[40vw] h-[40vw] max-w-[250px] max-h-[250px] mb-12 text-yr-black">
            <svg viewBox="37500 32600 2150 2100" xmlns="http://www.w3.org/2000/svg" class="w-full h-full drop-shadow-2xl">
                <g>
                    <polygon class="logo-fill" points="39589.06,32651.66 38610.11,32651.66 38610.11,33281.13 39129.42,33281.13 "/>
                    <polygon class="logo-fill" points="38665.88,33551.24 37627.67,32652.13 37571.88,32652.13 37571.88,33550.69 38610.09,34449.8 38665.88,34449.8 "/>
                    <polyline class="logo-stroke" stroke-width="80" stroke-linecap="round" stroke-linejoin="round" points="37571.88,32652.13 38610.09,33551.24 38610.09,34648.31 "/>
                    <polyline class="logo-stroke" stroke-width="80" stroke-linecap="round" stroke-linejoin="round" points="38610.11,32651.66 39589.06,32651.66 38934.65,33551.37 39284.08,33853.87 "/>
                    <polygon class="logo-stroke" stroke-width="20" points="38934.65,34180.84 39589.06,33281.13 39589.06,32651.66 38934.65,33551.37 "/>
                    <polygon class="logo-stroke" stroke-width="20" points="38934.65,33551.37 38934.65,34180.84 39284.08,34483.34 39284.08,33853.87 "/>
                </g>
            </svg>
        </div>
        <div class="portal-interactive-group text-fluid-xl tracking-[0.2em] font-light mb-2 text-center h-[40px]">
            <span class="portal-letter">Y</span>
            <svg class="portal-slash-svg w-[20px] h-[30px]" viewBox="0 0 10 20"><line x1="10" y1="0" x2="0" y2="20" vector-effect="non-scaling-stroke" /></svg>
            <span class="portal-letter">R</span>
            <svg class="portal-slash-svg w-[20px] h-[30px]" viewBox="0 0 10 20"><line x1="10" y1="0" x2="0" y2="20" vector-effect="non-scaling-stroke" /></svg>
            <span class="portal-letter">A</span>
        </div>
        <p class="text-fluid-xs text-gray-400 tracking-[0.4em] mb-16 pointer-events-none text-center">FROM VISION TO FORM.</p>
        <div class="flex space-x-8 md:space-x-12 text-fluid-base tracking-widest font-light z-10">
            <button onclick="enterSite('cn')" class="hover:text-yr-red transition-colors duration-300 py-2 px-4 border-b border-transparent hover:border-yr-red">中文</button>
            <span class="text-gray-300 font-light">/</span>
            <button onclick="enterSite('en')" class="hover:text-yr-red transition-colors duration-300 py-2 px-4 border-b border-transparent hover:border-yr-red">EN</button>
        </div>
    </div>

    <!-- Header -->
    <header id="header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-500 py-4 md:py-6 opacity-0 pointer-events-none">
        <div class="w-full px-[4vw] flex justify-between items-center">
            <a href="javascript:void(0)" onclick="backToPortal()" class="flex items-center gap-2 md:gap-3 group z-50 relative cursor-pointer">
                <svg viewBox="37500 32600 2150 2100" xmlns="http://www.w3.org/2000/svg" class="w-[6vw] h-[6vw] max-w-[40px] max-h-[40px] text-yr-black group-hover:text-yr-red transition-colors">
                    <g><polyline fill="none" stroke="currentColor" stroke-width="100" stroke-linecap="round" stroke-linejoin="round" points="37571.88,32652.13 38610.09,33551.24 38610.09,34648.31 "/><polyline fill="none" stroke="currentColor" stroke-width="100" stroke-linecap="round" stroke-linejoin="round" points="38610.11,32651.66 39589.06,32651.66 38934.65,33551.37 39284.08,33853.87 "/></g>
                </svg>
                <span class="text-fluid-base font-bold tracking-widest group-hover:text-yr-red transition-colors whitespace-nowrap">Y / R / A /</span>
            </a>
            <button id="hamburger-btn" onclick="toggleMobileMenu()" class="z-50 lg:hidden text-yr-black focus:outline-none p-2">
                <svg class="w-8 h-8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path class="hamburger-line line-1" d="M4 6H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path class="hamburger-line line-2" d="M4 12H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path class="hamburger-line line-3" d="M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            </button>
            <div class="hidden lg:flex items-center">
                <nav id="nav-cn" class="flex gap-[3vw] lg:gap-10 lang-nav hidden items-center mr-6 lg:mr-10">
                    <a href="#philosophy-cn" class="text-fluid-sm font-medium tracking-widest text-gray-500 hover:text-yr-red link-underline whitespace-nowrap">/ 底蘊 /</a>
                    <a href="#structure-cn" class="text-fluid-sm font-medium tracking-widest text-gray-500 hover:text-yr-red link-underline whitespace-nowrap">/ 架構 /</a>
                    <a href="#projects-cn" class="text-fluid-sm font-medium tracking-widest text-gray-500 hover:text-yr-red link-underline whitespace-nowrap">/ 作品 /</a>
                    <a href="#contact-cn" class="text-fluid-sm font-medium tracking-widest text-gray-500 hover:text-yr-red link-underline whitespace-nowrap">/ 聯繫 /</a>
                </nav>
                <nav id="nav-en" class="flex gap-[3vw] lg:gap-10 lang-nav hidden items-center mr-6 lg:mr-10">
                    <a href="#philosophy-en" class="text-fluid-xs font-medium tracking-widest text-gray-500 hover:text-yr-red uppercase link-underline whitespace-nowrap">/ Philosophy /</a>
                    <a href="#structure-en" class="text-fluid-xs font-medium tracking-widest text-gray-500 hover:text-yr-red uppercase link-underline whitespace-nowrap">/ Structure /</a>
                    <a href="#projects-en" class="text-fluid-xs font-medium tracking-widest text-gray-500 hover:text-yr-red uppercase link-underline whitespace-nowrap">/ Projects /</a>
                    <a href="#contact-en" class="text-fluid-xs font-medium tracking-widest text-gray-500 hover:text-yr-red uppercase link-underline whitespace-nowrap">/ Contact /</a>
                </nav>
                <div class="flex gap-4 items-center border-l border-gray-300 pl-4 lg:pl-6">
                    <!-- Social Icons -->
                    <a href="https://www.facebook.com/yroom.tc" target="_blank" class="text-gray-400 hover:text-yr-red transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a>
                    <a href="https://www.instagram.com/yroom.tw/" target="_blank" class="text-gray-400 hover:text-yr-red transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg></a>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobile-menu">
        <nav id="mobile-nav-cn" class="flex flex-col gap-8 text-center items-center hidden">
            <a href="#philosophy-cn" onclick="toggleMobileMenu()" class="text-fluid-xl font-light tracking-widest text-yr-black hover:text-yr-red">/ 底蘊 /</a>
            <a href="#structure-cn" onclick="toggleMobileMenu()" class="text-fluid-xl font-light tracking-widest text-yr-black hover:text-yr-red">/ 架構 /</a>
            <a href="#projects-cn" onclick="toggleMobileMenu()" class="text-fluid-xl font-light tracking-widest text-yr-black hover:text-yr-red">/ 作品 /</a>
            <a href="#contact-cn" onclick="toggleMobileMenu()" class="text-fluid-xl font-light tracking-widest text-yr-black hover:text-yr-red">/ 聯繫 /</a>
        </nav>
        <nav id="mobile-nav-en" class="flex flex-col gap-8 text-center items-center hidden">
            <a href="#philosophy-en" onclick="toggleMobileMenu()" class="text-fluid-lg font-light tracking-widest text-yr-black hover:text-yr-red uppercase">/ Philosophy /</a>
            <a href="#structure-en" onclick="toggleMobileMenu()" class="text-fluid-lg font-light tracking-widest text-yr-black hover:text-yr-red uppercase">/ Structure /</a>
            <a href="#projects-en" onclick="toggleMobileMenu()" class="text-fluid-lg font-light tracking-widest text-yr-black hover:text-yr-red uppercase">/ Projects /</a>
            <a href="#contact-en" onclick="toggleMobileMenu()" class="text-fluid-lg font-light tracking-widest text-yr-black hover:text-yr-red uppercase">/ Contact /</a>
        </nav>
    </div>

    <!-- Overlays -->
    <div id="transition-overlay">
        <div id="trans-logo-arch" class="w-[30vw] h-[30vw] max-w-[200px] max-h-[200px] text-yr-black hidden">
             <svg viewBox="81800 47660 2020 1860" xmlns="http://www.w3.org/2000/svg" class="w-full h-full"><g><polygon class="trans-svg-path" stroke="currentColor" fill="none" points="83165.26,49195.46 83819.67,48295.75 83819.67,47666.28 83165.26,48565.99 "/><polygon class="trans-svg-path" stroke="currentColor" fill="none" points="83819.67,47666.28 82840.72,47666.28 82840.72,48295.75 83360.03,48295.75 "/><polygon class="trans-svg-path" stroke="currentColor" fill="none" points="82896.49,48614.18 81802.49,47666.75 81802.49,48565.31 82896.49,49512.74 "/><polygon class="trans-svg-path" stroke="currentColor" fill="none" points="83165.26,48565.99 83165.26,49195.46 83514.69,49497.96 83514.69,48868.49 "/></g></svg>
        </div>
        <div id="trans-logo-room" class="w-[30vw] h-[30vw] max-w-[200px] max-h-[200px] text-yr-black hidden">
            <svg viewBox="46070 26370 2030 2000" xmlns="http://www.w3.org/2000/svg" class="w-full h-full"><g><polyline class="trans-svg-path" stroke="currentColor" fill="none" points="46073.72,26373.49 47111.93,27272.6 47111.93,28369.67 "/><polyline class="trans-svg-path" stroke="currentColor" fill="none" points="47111.95,26373.02 48090.9,26373.02 47436.49,27272.73 47785.92,27575.23 "/></g></svg>
        </div>
    </div>

    <div id="all-projects-overlay" class="overlay-fixed bg-yr-white">
        <div onclick="closeAllProjects()" class="close-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div>
        <div class="w-full px-[4vw] py-[10vh]">
            <h2 class="text-fluid-xl font-light tracking-widest text-yr-black mb-12 text-center">ALL PROJECTS</h2>
            <!-- Responsive Grid: 1 col on mobile, 2 on tablet, 3 on desktop. Larger Y gap for mobile -->
            <div id="projects-grid-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-[3vw] gap-y-16 md:gap-y-[5vh]"></div>
        </div>
    </div>

    <div id="project-detail-overlay" class="overlay-fixed bg-white z-[70]">
        <div onclick="closeProjectDetail()" class="close-btn fixed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div>
        <div id="project-detail-content" class="w-full min-h-screen pb-20"></div>
    </div>

    <!-- MAIN CONTENT -->
    <main id="main-content" class="bg-grid-pattern min-h-screen pt-0 hidden">
        <!-- CN -->
        <div id="content-cn" class="lang-section">
            <section id="hero-cn" class="relative h-[100dvh] flex flex-col justify-center items-center text-center px-6">
                <div class="animate-on-scroll">
                    <h2 class="text-fluid-2xl font-light tracking-widest text-yr-black mb-6 hero-float" data-text-key="hero-title-cn">肇於意，成於形</h2>
                    <p class="text-fluid-sm text-yr-red tracking-[0.3em] font-medium mb-8" data-text-key="hero-subtitle-cn">FROM VISION TO FORM</p>
                    <div class="w-12 h-[1px] bg-yr-black mx-auto opacity-20 mb-8"></div>
                </div>
                <div class="absolute bottom-[10vh] w-full px-[10vw] text-center animate-on-scroll" style="transition-delay: 0.3s;">
                    <p class="text-fluid-sm text-gray-600 leading-loose font-light tracking-wide text-center" data-text-key="hero-desc-cn">
                        YR ATELIER (Y.R.A.) 一個跨領域設計品牌。<br>它不僅是一個結合建築與室內設計的工作體系，更是一種思維方式 ——<br>在秩序與自由、形與留白、光與影之間尋找平衡。
                    </p>
                </div>
            </section>
            <section id="philosophy-cn" class="py-[10vh] px-[4vw] bg-white border-t border-gray-100 scroll-mt-20">
                <div class="w-full flex flex-col md:flex-row gap-[4vw]">
                    <div class="w-full md:w-1/3 animate-on-scroll text-left">
                        <h2 class="text-fluid-lg font-bold text-yr-red tracking-[0.2em] mb-4">品牌哲學</h2>
                        <h3 class="text-fluid-xl font-light text-yr-black tracking-widest leading-snug" id="philo-header-cn"><span data-text-key="philo-title-cn">{ / }</span><br><span class="text-fluid-sm text-gray-400" data-text-key="philo-subtitle-cn">在分界之間，找到自由。</span></h3>
                    </div>
                    <div class="w-full md:w-2/3 grid grid-cols-1 md:grid-cols-2 gap-[4vw] animate-on-scroll" style="transition-delay: 0.2s;">
                        <div class="text-fluid-sm text-gray-600 leading-relaxed font-light tracking-wide text-justify">
                            <p class="mb-6" data-text-key="philo-text-1-cn">「 / 」是一個分界符號，也是一種意識狀態。一側代表向外的創造力與光；另一側則代表向內的覺知與靜度。</p>
                        </div>
                        <div class="text-fluid-sm text-gray-600 leading-relaxed font-light tracking-wide text-justify border-l md:border-l border-gray-100 pl-[2vw]">
                            <p class="mb-6" data-text-key="philo-text-2-cn">「肇於意，成於形」-我們追求著是起心動念的那一瞬的靈光乍現。建築與室內的界線，是我們思考的起點。</p>
                        </div>
                    </div>
                </div>
            </section>
            <section id="structure-cn" class="py-[10vh] px-[4vw] bg-yr-white scroll-mt-20">
                <div class="w-full animate-on-scroll">
                    <div class="text-center mb-[5vh]"><h2 class="text-fluid-xl font-light tracking-widest text-yr-black">品牌架構</h2></div>
                    <div class="flex flex-col md:flex-row justify-center items-stretch w-full gap-4 md:gap-0">
                        <div onclick="toggleLeader('arch', 'cn')" class="flex-1 bg-white p-[2vw] py-[4vh] text-center border border-gray-100 hover:border-yr-black transition-all duration-500 group cursor-pointer hover:shadow-lg">
                            <h3 class="text-fluid-lg tracking-widest mb-2 group-hover:text-yr-red transition-colors whitespace-nowrap">逸離建築</h3><p class="text-fluid-sm text-gray-400 tracking-widest mb-[3vh]">YE/RI ARCHITECTS</p><div class="w-8 h-[1px] bg-yr-black mx-auto mb-[3vh]"></div><p class="text-fluid-sm text-gray-600 font-light tracking-wide">建築設計 / 景觀</p><p class="mt-[3vh] text-fluid-sm text-yr-black font-bold tracking-[0.2em]">超越形體</p>
                            <div id="leader-arch-cn" class="leader-reveal flex flex-col items-center justify-center"><div class="w-4 h-[1px] bg-yr-red mx-auto mb-4"></div><p class="text-fluid-base text-yr-black font-medium tracking-widest mb-4">主持人 陳嘉君</p><div class="w-[40px] h-[40px]"><svg viewBox="81800 47660 2020 1860" xmlns="http://www.w3.org/2000/svg" class="w-full h-full text-gray-400"><g><polygon class="structure-svg-path" stroke="currentColor" fill="none" points="83165.26,49195.46 83819.67,48295.75 83819.67,47666.28 83165.26,48565.99 "/><polygon class="structure-svg-path" stroke="currentColor" fill="none" points="83819.67,47666.28 82840.72,47666.28 82840.72,48295.75 83360.03,48295.75 "/><polygon class="structure-svg-path" stroke="currentColor" fill="none" points="82896.49,48614.18 81802.49,47666.75 81802.49,48565.31 82896.49,49512.74 "/><polygon class="structure-svg-path" stroke="currentColor" fill="none" points="83165.26,48565.99 83165.26,49195.46 83514.69,49497.96 83514.69,48868.49 "/></g></svg></div></div>
                        </div>
                        <div class="hidden md:flex flex-col justify-center items-center px-[2vw]"><div class="w-[1px] h-full bg-gray-300"></div></div>
                        <div onclick="toggleLeader('interior', 'cn')" class="flex-1 bg-white p-[2vw] py-[4vh] text-center border border-gray-100 hover:border-yr-black transition-all duration-500 group cursor-pointer hover:shadow-lg">
                            <h3 class="text-fluid-lg tracking-widest mb-2 group-hover:text-yr-red transition-colors whitespace-nowrap">韻室設計</h3><p class="text-fluid-sm text-gray-400 tracking-widest mb-[3vh]">Y/ROOM</p><div class="w-8 h-[1px] bg-yr-black mx-auto mb-[3vh]"></div><p class="text-fluid-sm text-gray-600 font-light tracking-wide">室內設計 / 生活</p><p class="mt-[3vh] text-fluid-sm text-yr-black font-bold tracking-[0.2em]">韻於生活</p>
                            <div id="leader-interior-cn" class="leader-reveal flex flex-col items-center justify-center"><div class="w-4 h-[1px] bg-yr-red mx-auto mb-4"></div><p class="text-fluid-base text-yr-black font-medium tracking-widest mb-4">總監 趙韻蓉</p><div class="w-[40px] h-[40px]"><svg viewBox="46070 26370 2030 2000" xmlns="http://www.w3.org/2000/svg" class="w-full h-full text-gray-400"><g><polyline class="structure-svg-path" stroke="currentColor" fill="none" points="46073.72,26373.49 47111.93,27272.6 47111.93,28369.67 "/><polyline class="structure-svg-path" stroke="currentColor" fill="none" points="47111.95,26373.02 48090.9,26373.02 47436.49,27272.73 47785.92,27575.23 "/></g></svg></div></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Dynamic Projects Section -->
            <section id="projects-cn" class="py-[10vh] bg-white scroll-mt-20">
                <div class="w-full px-[4vw]">
                    <div class="flex justify-between items-end mb-[5vh] animate-on-scroll">
                        <div><h2 class="text-fluid-xl font-light tracking-widest text-yr-black">近期作品</h2></div>
                        <button onclick="openAllProjects()" class="text-fluid-xs font-bold text-yr-red tracking-widest border-b border-yr-red pb-1 whitespace-nowrap hover:text-yr-black hover:border-yr-black transition-colors">查看全部</button>
                    </div>
                    <!-- Main Page Preview -->
                    <!-- Updated Grid: Larger Gap for mobile -->
                    <div id="featured-projects-cn" class="grid grid-cols-1 md:grid-cols-2 gap-12 md:gap-[4vw]">
                        <!-- Injected by JS -->
                    </div>
                </div>
            </section>
            <section id="contact-cn" class="py-[15vh] px-[4vw] text-center bg-yr-white border-t border-gray-200 scroll-mt-20">
                <div class="w-full animate-on-scroll">
                    <h2 class="text-fluid-2xl font-light tracking-widest text-yr-black mb-[3vh]">從構想到形體</h2>
                    <h3 class="text-fluid-lg font-light tracking-widest text-gray-500 mb-[3vh]">肇於意，成於形</h3>
                    <p class="text-gray-500 font-light tracking-widest leading-loose mb-[3vh] text-fluid-sm">我們相信空間的核心，不在於區隔，而在於連結。<br>在理性與詩性之間，尋找思想的留白。</p>
                    <a href="mailto:reccadna@gmail.com" class="inline-block bg-yr-red text-white px-[3vw] py-[2vh] text-fluid-xs font-bold tracking-[0.2em] hover:bg-yr-black transition-colors duration-300">開始對話</a>
                </div>
            </section>
        </div>

        <!-- EN -->
        <div id="content-en" class="lang-section">
             <section id="hero-en" class="relative h-[100dvh] flex flex-col justify-center items-center text-center px-6">
                <div class="animate-on-scroll">
                    <p class="text-fluid-base text-yr-red tracking-[0.3em] uppercase font-medium mb-8 hero-float">FROM VISION TO FORM.</p>
                    <div class="w-12 h-[1px] bg-yr-black mx-auto opacity-20 mb-8"></div>
                </div>
                <div class="absolute bottom-[10vh] w-full px-[10vw] text-center animate-on-scroll" style="transition-delay: 0.3s;">
                    <p class="text-fluid-sm text-gray-600 leading-loose font-light tracking-wide text-center">
                        YR ATELIER (Y.R.A.) <br>
                        <span class="text-yr-black font-medium">A multidisciplinary design brand. It is not merely a practice integrating architecture and interior design, but a mindset.</span>
                    </p>
                </div>
            </section>
            <section id="philosophy-en" class="py-[10vh] px-[4vw] bg-white border-t border-gray-100 scroll-mt-20">
                 <div class="w-full flex flex-col md:flex-row gap-[4vw]">
                    <div class="w-full md:w-1/3 animate-on-scroll text-left">
                        <h2 class="text-fluid-base font-bold text-yr-red tracking-[0.2em] mb-4">BRAND PRINCIPLE</h2>
                        <h3 class="text-fluid-xl font-light text-yr-black tracking-widest leading-snug">{/}<br><span class="text-fluid-xs text-gray-400">Clarity and Calm.</span></h3>
                    </div>
                    <div class="w-full md:w-2/3 grid grid-cols-1 md:grid-cols-2 gap-[4vw] animate-on-scroll" style="transition-delay: 0.2s;">
                        <div class="text-fluid-sm text-gray-600 leading-relaxed font-light tracking-wide text-justify"><p class="mb-6">「 / 」 is a symbol of threshold and a state of awareness.</p></div>
                        <div class="text-fluid-sm text-gray-600 leading-relaxed font-light tracking-wide text-justify border-l md:border-l border-gray-100 pl-[2vw]"><p class="mb-6">“FROM VISION TO FORM”—we pursue that fleeting moment of inspiration.</p></div>
                    </div>
                </div>
            </section>
             <section id="structure-en" class="py-[10vh] px-[4vw] bg-yr-white scroll-mt-20">
                <div class="w-full animate-on-scroll text-center mb-[5vh]"><h2 class="text-fluid-xl font-light tracking-widest text-yr-black">Structure</h2></div>
                 <!-- Structure Content same as CN logic, omitted for space -->
             </section>
             <section id="projects-en" class="py-[10vh] bg-white scroll-mt-20">
                <div class="w-full px-[4vw]">
                    <div class="flex justify-between items-end mb-[5vh] animate-on-scroll">
                        <div><h2 class="text-fluid-xl font-light tracking-widest text-yr-black">Selected Projects</h2></div>
                        <button onclick="openAllProjects()" class="text-fluid-xs font-bold text-yr-red tracking-widest border-b border-yr-red pb-1 whitespace-nowrap hover:text-yr-black hover:border-yr-black transition-colors">VIEW ALL</button>
                    </div>
                    <div id="featured-projects-en" class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-[4vw]"></div>
                </div>
             </section>
             <section id="contact-en" class="py-[15vh] px-[4vw] text-center bg-yr-white border-t border-gray-200 scroll-mt-20">
                 <div class="w-full animate-on-scroll"><h2 class="text-fluid-2xl font-light tracking-widest text-yr-black mb-[3vh]">From Vision to Form</h2><a href="mailto:reccadna@gmail.com" class="inline-block bg-yr-red text-white px-[3vw] py-[2vh] text-fluid-xs font-bold tracking-[0.2em] hover:bg-yr-black transition-colors duration-300">CONTACT US</a></div>
             </section>
        </div>
    </main>

    <!-- Footer with Admin Link -->
    <footer class="bg-yr-white py-8 text-center border-t border-gray-200">
        <button onclick="openAdminLogin()" class="text-gray-300 hover:text-yr-red text-xs tracking-widest cursor-pointer transition-colors">Y.R.A</button>
    </footer>

    <!-- Admin Login Modal -->
    <div id="login-modal" class="admin-modal">
        <div class="bg-white p-8 w-[90%] max-w-[400px] text-center shadow-2xl relative">
            <div onclick="closeAdminLogin()" class="absolute top-4 right-4 cursor-pointer">✕</div>
            <h3 class="text-xl font-light tracking-widest mb-6">BACKEND LOGIN</h3>
            <input type="text" id="admin-id" placeholder="ID" class="w-full border-b border-gray-300 p-2 mb-4 outline-none focus:border-yr-red tracking-widest">
            <input type="password" id="admin-pw" placeholder="PASSWORD" class="w-full border-b border-gray-300 p-2 mb-8 outline-none focus:border-yr-red tracking-widest">
            <button onclick="attemptLogin()" class="bg-yr-black text-white px-6 py-2 tracking-widest hover:bg-yr-red transition-colors w-full">ENTER</button>
        </div>
    </div>

    <!-- Admin Dashboard Overlay -->
    <div id="admin-dashboard" class="overlay-fixed bg-yr-white z-[90]">
        <div onclick="closeAdminDashboard()" class="close-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div>
        <div class="w-full h-full flex flex-col">
            <div class="h-[10vh] flex items-center justify-center border-b border-gray-200 bg-white">
                <h2 class="text-fluid-lg tracking-widest">ADMIN DASHBOARD</h2>
            </div>
            <div class="flex flex-1 overflow-hidden">
                <!-- Sidebar -->
                <div class="w-1/4 bg-white border-r border-gray-200 flex flex-col p-6 gap-4">
                    <button onclick="switchAdminTab('projects')" id="tab-projects" class="dashboard-tab text-left py-2 text-gray-500 hover:text-yr-red tracking-widest active">PROJECTS</button>
                    <button onclick="switchAdminTab('texts')" id="tab-texts" class="dashboard-tab text-left py-2 text-gray-500 hover:text-yr-red tracking-widest">SITE TEXTS</button>
                </div>
                <!-- Content -->
                <div class="w-3/4 p-8 overflow-y-auto bg-gray-50">
                    <!-- Projects Panel -->
                    <div id="panel-projects">
                        <button onclick="addNewProject()" class="mb-8 bg-yr-red text-white px-4 py-2 text-sm tracking-widest hover:bg-black transition-colors">+ NEW PROJECT</button>
                        <div id="admin-projects-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- JS generated -->
                        </div>
                    </div>
                    <!-- Texts Panel -->
                    <div id="panel-texts" class="hidden">
                         <div id="admin-texts-list" class="space-y-6">
                            <!-- JS generated -->
                         </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Project Modal -->
    <div id="edit-project-modal" class="admin-modal z-[100]">
        <div class="bg-white p-8 w-[90%] max-w-[600px] max-h-[90vh] overflow-y-auto shadow-2xl relative">
            <div onclick="closeEditModal()" class="absolute top-4 right-4 cursor-pointer text-xl">✕</div>
            <h3 class="text-xl font-light tracking-widest mb-6 text-center" id="edit-modal-title">EDIT PROJECT</h3>
            <div class="space-y-4">
                <input type="hidden" id="edit-p-id">
                <div><label class="text-xs text-gray-400">TITLE</label><input id="edit-p-title" class="w-full border p-2"></div>
                <div><label class="text-xs text-gray-400">TYPE</label><input id="edit-p-type" class="w-full border p-2"></div>
                <div><label class="text-xs text-gray-400">LOCATION</label><input id="edit-p-location" class="w-full border p-2"></div>
                <div><label class="text-xs text-gray-400">YEAR</label><input id="edit-p-year" class="w-full border p-2"></div>
                <div><label class="text-xs text-gray-400">DESIGN BY</label><input id="edit-p-design" class="w-full border p-2"></div>
                <div><label class="text-xs text-gray-400">PHOTOGRAPHY</label><input id="edit-p-photo" class="w-full border p-2"></div>
                <div><label class="text-xs text-gray-400">TAG (YE/RI or Y/ROOM)</label><input id="edit-p-tag" class="w-full border p-2"></div>
                <div><label class="text-xs text-gray-400">MAIN IMAGE URL</label><input id="edit-p-image" class="w-full border p-2"></div>
                <div><label class="text-xs text-gray-400">GALLERY URLS (Comma separated)</label><textarea id="edit-p-images" class="w-full border p-2 h-20"></textarea></div>
                <div><label class="text-xs text-gray-400">DESCRIPTION (HTML Allowed)</label><textarea id="edit-p-desc" class="w-full border p-2 h-32"></textarea></div>
                <div class="flex items-center gap-2"><input type="checkbox" id="edit-p-coming"><label class="text-sm">Coming Soon Mode</label></div>
                <button onclick="submitProjectEdit()" class="w-full bg-yr-black text-white py-3 mt-4 tracking-widest hover:bg-yr-red">SAVE</button>
            </div>
        </div>
    </div>

    <!-- Main Script - Moved Initial Data Here -->
    <script>
        // --- Initial Data for Immediate Render ---
        window.initialProjects = [
             {
                id: "0",
                title: "House.C",
                type: "Single Family Residence",
                location: "Nantou, Taiwan",
                year: "2020",
                designBy: "@yroom.tw",
                photography: "@cch.tw",
                tag: "YE/RI",
                image: "https://images.unsplash.com/photo-1517555832075-973b0783c86f?q=80&w=1000&auto=format&fit=crop",
                images: [
                    "https://images.unsplash.com/photo-1517555832075-973b0783c86f?q=80&w=1000&auto=format&fit=crop",
                    "https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?q=80&w=1000&auto=format&fit=crop",
                    "https://images.unsplash.com/photo-1600607687644-c7171b42498b?q=80&w=1000&auto=format&fit=crop"
                ],
                description: "結廬在人境，而無車馬喧<br>-東晉 陶潛 《飲酒詩　其五》<br><br>居所，這座漂浮在時間河流中的孤島..."
            },
            {
                id: "1",
                title: "Quiet Light House",
                type: "Apartment Renovation",
                location: "Taipei, Taiwan",
                year: "2021",
                designBy: "@yroom.tw",
                photography: "@cch.tw",
                tag: "Y/ROOM",
                image: "https://images.unsplash.com/photo-1618221195710-dd6b41faaea6?q=80&w=1000&auto=format&fit=crop",
                images: ["https://images.unsplash.com/photo-1618221195710-dd6b41faaea6?q=80&w=1000&auto=format&fit=crop"],
                description: "光是空間的詩。<br><br>在台北這座繁忙的城市中，我們試圖為居住者尋找一抹純淨的光..."
            },
             { id: "2", title: "Forest Villa", type: "Vacation Home", location: "Yilan", year: "2019", designBy: "@yroom", photography: "@cch", tag: "YE/RI", image: "https://images.unsplash.com/photo-1600596542815-205db241b054?q=80&w=1000&auto=format&fit=crop", images: ["https://images.unsplash.com/photo-1600596542815-205db241b054?q=80&w=1000&auto=format&fit=crop"], description: "森之呼吸。" },
             { id: "3", title: "Urban Loft", type: "Residential", location: "Taichung", year: "2022", designBy: "@yroom", photography: "@cch", tag: "Y/ROOM", image: "https://images.unsplash.com/photo-1507089947368-19c1da9775ae?q=80&w=1000&auto=format&fit=crop", images: ["https://images.unsplash.com/photo-1507089947368-19c1da9775ae?q=80&w=1000&auto=format&fit=crop"], description: "垂直生活的想像。" },
             { id: "4", title: "Gray Scale", type: "Office", location: "Hsinchu", year: "2021", designBy: "@yroom", photography: "@cch", tag: "Y/ROOM", image: "https://images.unsplash.com/photo-1497366216548-37526070297c?q=80&w=1000&auto=format&fit=crop", images: ["https://images.unsplash.com/photo-1497366216548-37526070297c?q=80&w=1000&auto=format&fit=crop"], description: "理性的灰階。" },
             { id: "5", title: "The Courtyard", type: "Single Family", location: "Tainan", year: "2023", designBy: "@yroom", photography: "@cch", tag: "YE/RI", image: "https://images.unsplash.com/photo-1523217582562-09d0def993a6?q=80&w=1000&auto=format&fit=crop", images: ["https://images.unsplash.com/photo-1523217582562-09d0def993a6?q=80&w=1000&auto=format&fit=crop"], description: "內向的宇宙。" },
             { id: "6", title: "Tea House", type: "Commercial", location: "Kyoto", year: "2018", designBy: "@yroom", photography: "@cch", tag: "YE/RI", image: "https://images.unsplash.com/photo-1522771753035-1a5b6562f3ba?q=80&w=1000&auto=format&fit=crop", images: ["https://images.unsplash.com/photo-1522771753035-1a5b6562f3ba?q=80&w=1000&auto=format&fit=crop"], description: "一期一會。" },
             { id: "7", title: "Concrete Flow", type: "Gallery", location: "Kaohsiung", year: "2022", designBy: "@yroom", photography: "@cch", tag: "YE/RI", image: "https://images.unsplash.com/photo-1518005052360-2037c3758ce2?q=80&w=1000&auto=format&fit=crop", images: ["https://images.unsplash.com/photo-1518005052360-2037c3758ce2?q=80&w=1000&auto=format&fit=crop"], description: "凝固的流動。" },
             { id: "8", title: "Mountain Retreat", type: "Hospitality", location: "Miaoli", year: "2020", designBy: "@yroom", photography: "@cch", tag: "YE/RI", image: "https://images.unsplash.com/photo-1449844908441-8829872d2607?q=80&w=1000&auto=format&fit=crop", images: ["https://images.unsplash.com/photo-1449844908441-8829872d2607?q=80&w=1000&auto=format&fit=crop"], description: "山居歲月。" },
             { id: "9", title: "White Cube", type: "Studio", location: "Taipei", year: "2023", designBy: "@yroom", photography: "@cch", tag: "Y/ROOM", image: "https://images.unsplash.com/photo-1497215728101-856f4ea42174?q=80&w=1000&auto=format&fit=crop", images: ["https://images.unsplash.com/photo-1497215728101-856f4ea42174?q=80&w=1000&auto=format&fit=crop"], description: "純粹的容器。" },
             { id: "10", title: "Coming Soon", type: "Future", tag: "Y/R/A", isComingSoon: true }
        ];

        window.initialTexts = {
            "hero-title-cn": "肇於意，成於形",
            "hero-subtitle-cn": "FROM VISION TO FORM",
            "hero-desc-cn": "YR ATELIER (Y.R.A.) 一個跨領域設計品牌。<br>它不僅是一個結合建築與室內設計的工作體系，更是一種思維方式 ——<br>在秩序與自由、形與留白、光與影之間尋找平衡。",
            "philo-title-cn": "{ / }",
            "philo-subtitle-cn": "在分界之間，找到自由。",
            "philo-text-1-cn": "「 / 」是一個分界符號，也是一種意識狀態。一側代表向外的創造力與光；另一側則代表向內的覺知與靜度。",
            "philo-text-2-cn": "「肇於意，成於形」-我們追求著是起心動念的那一瞬的靈光乍現。建築與室內的界線，是我們思考的起點。"
        };
        
        // Assign immediately to prevent blank flash
        window.projectsData = window.initialProjects;
        window.siteTexts = window.initialTexts;

        // --- Core Logic ---
        let currentLang = 'cn';

        function enterSite(lang) {
            currentLang = lang;
            document.getElementById('portal').classList.add('portal-fade-out');
            setTimeout(() => {
                document.getElementById('portal').style.display = 'none';
                document.getElementById('header').classList.remove('opacity-0', 'pointer-events-none');
                document.getElementById('main-content').classList.remove('hidden');
                switchLanguage(lang);
                checkScroll();
                // Ensure projects are rendered when entering
                if(window.projectsData) renderFrontendProjects(window.projectsData);
            }, 800);
        }

        function backToPortal() {
            document.getElementById('mobile-menu').classList.remove('open');
            closeAllProjects();
            closeProjectDetail();
            closeAdminDashboard();
            document.getElementById('header').classList.add('opacity-0', 'pointer-events-none');
            const portal = document.getElementById('portal');
            portal.style.display = 'flex';
            void portal.offsetWidth;
            portal.classList.remove('portal-fade-out');
            setTimeout(() => {
                document.getElementById('main-content').classList.add('hidden');
                window.scrollTo(0, 0);
            }, 500);
        }

        function switchLanguage(lang) {
            document.querySelectorAll('.lang-section').forEach(el => el.classList.remove('active'));
            const targetContent = document.getElementById(`content-${lang}`);
            if (targetContent) targetContent.classList.add('active');
            document.querySelectorAll('.lang-nav').forEach(el => { el.classList.add('hidden'); el.classList.remove('flex'); });
            const targetNav = document.getElementById(`nav-${lang}`);
            if (targetNav) { targetNav.classList.remove('hidden'); targetNav.classList.add('flex'); }
            document.getElementById('mobile-nav-cn').classList.add('hidden');
            document.getElementById('mobile-nav-en').classList.add('hidden');
            const targetMobileNav = document.getElementById(`mobile-nav-${lang}`);
            if(targetMobileNav) targetMobileNav.classList.remove('hidden');
        }

        function toggleLeader(type, lang) {
            document.getElementById(`leader-${type}-${lang}`).classList.toggle('show');
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const btn = document.getElementById('hamburger-btn');
            menu.classList.toggle('open');
            btn.classList.toggle('hamburger-active');
            document.body.style.overflow = menu.classList.contains('open') ? 'hidden' : '';
        }

        function checkScroll() {
            const elements = document.querySelectorAll('.animate-on-scroll');
            const windowHeight = window.innerHeight;
            elements.forEach(el => {
                if (el.getBoundingClientRect().top < windowHeight * 0.9) el.classList.add('is-visible');
            });
            const header = document.getElementById('header');
            if (window.scrollY > 50) header.classList.add('bg-white/90', 'backdrop-blur-sm', 'shadow-sm');
            else header.classList.remove('bg-white/90', 'backdrop-blur-sm', 'shadow-sm');
        }
        window.addEventListener('scroll', checkScroll);

        // --- Dynamic Rendering Functions ---

        window.renderTexts = () => {
            const texts = window.siteTexts || {};
            document.querySelectorAll('[data-text-key]').forEach(el => {
                const key = el.getAttribute('data-text-key');
                if(texts[key]) el.innerHTML = texts[key];
            });
        };

        // Updated Project Render Function with Better Mobile Layout
        window.renderFrontendProjects = (data) => {
            if(!data) return;
            const realProjects = data.filter(p => !p.isComingSoon);
            const previewProjects = realProjects.slice(0, 2);
            const cnContainer = document.getElementById('featured-projects-cn');
            const enContainer = document.getElementById('featured-projects-en');
            
            const createCard = (p) => `
                <div class="group cursor-pointer animate-on-scroll is-visible" onclick="openProjectDetail('${p.id}')">
                    <div class="aspect-[4/3] bg-gray-100 overflow-hidden relative">
                        <!-- Mobile: Color (grayscale-0) / Desktop: Grayscale (md:grayscale) -->
                        <img src="${p.image}" class="w-full h-full object-cover transition-transform duration-700 grayscale-0 md:grayscale md:group-hover:grayscale-0">
                        <div class="absolute top-4 left-4 bg-yr-black text-white text-[10px] px-2 py-1 tracking-widest">${p.tag}</div>
                    </div>
                    <div class="mt-[2vh]">
                        <h3 class="text-fluid-base font-light tracking-widest group-hover:text-yr-red transition-colors">${p.title}</h3>
                        <p class="text-fluid-xs text-gray-400 mt-1 tracking-wider">${p.type} / ${p.location}</p>
                    </div>
                </div>
            `;

            if(cnContainer) cnContainer.innerHTML = previewProjects.map(createCard).join('');
            if(enContainer) enContainer.innerHTML = previewProjects.map(createCard).join('');
        };

        // --- Overlays Logic ---

        window.openAllProjects = () => {
            const data = window.projectsData || [];
            const container = document.getElementById('projects-grid-container');
            container.innerHTML = data.map(p => {
                if (p.isComingSoon) {
                    return `
                        <div class="aspect-[4/3] bg-gray-200 flex items-center justify-center flex-col text-yr-grey">
                            <span class="text-fluid-lg tracking-widest font-light">COMING SOON</span>
                            <div class="w-8 h-[1px] bg-gray-400 my-2"></div>
                            <span class="text-fluid-xs tracking-widest">Y/R/A</span>
                        </div>`;
                }
                return `
                    <div class="project-card group cursor-pointer" onclick="openProjectDetail('${p.id}')">
                        <div class="aspect-[4/3] bg-gray-100 overflow-hidden relative">
                            <!-- Mobile: Color / Desktop: Grayscale -->
                            <img src="${p.image}" class="project-img w-full h-full object-cover transition-transform duration-700 grayscale-0 md:grayscale md:group-hover:grayscale-0">
                            <div class="absolute top-4 left-4 bg-yr-black text-white text-[10px] px-2 py-1 tracking-widest">${p.tag}</div>
                        </div>
                        <div class="mt-[2vh]">
                            <h3 class="text-fluid-base font-light tracking-widest group-hover:text-yr-red transition-colors">${p.title}</h3>
                            <p class="text-fluid-xs text-gray-400 mt-1 tracking-wider">${p.type}</p>
                        </div>
                    </div>`;
            }).join('');
            document.getElementById('all-projects-overlay').classList.add('open');
            document.body.style.overflow = 'hidden';
        };

        window.closeAllProjects = () => {
            document.getElementById('all-projects-overlay').classList.remove('open');
            document.body.style.overflow = '';
        };

        // Detail & Transition
        let currentProjectImages = [];
        window.openProjectDetail = (id) => {
            const data = window.projectsData || [];
            const project = data.find(p => p.id == id);
            if (!project) return;

            const transOverlay = document.getElementById('transition-overlay');
            document.getElementById('trans-logo-arch').classList.add('hidden');
            document.getElementById('trans-logo-room').classList.add('hidden');
            transOverlay.classList.remove('trans-anim-active');

            if (project.tag.includes('YE/RI')) document.getElementById('trans-logo-arch').classList.remove('hidden');
            else document.getElementById('trans-logo-room').classList.remove('hidden');

            transOverlay.classList.add('active');
            setTimeout(() => transOverlay.classList.add('trans-anim-active'), 50);

            currentProjectImages = project.images && project.images.length > 0 ? project.images : [project.image];
            
            setTimeout(() => {
                const content = document.getElementById('project-detail-content');
                content.innerHTML = `
                    <div class="w-full h-[60vh] md:h-[80vh] bg-gray-100 overflow-hidden relative mb-[5vh] group">
                        <img id="detail-main-image" src="${currentProjectImages[0]}" class="w-full h-full object-cover transition-all duration-500">
                        <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/50 to-transparent h-[30%] pointer-events-none"></div>
                        <div class="absolute bottom-[5vh] left-[4vw] text-white pointer-events-none">
                            <h1 class="text-fluid-2xl font-light tracking-widest mb-2">${project.title}</h1>
                            <p class="text-fluid-sm tracking-widest opacity-90">${project.tag} / ${project.year}</p>
                        </div>
                        <div class="absolute bottom-[2vh] right-[4vw] left-[4vw] flex flex-col items-end z-10">
                             <div class="text-white text-xs tracking-widest mb-2 bg-black/30 px-2 py-1 backdrop-blur-sm"><span id="image-counter">1</span> / ${currentProjectImages.length}</div>
                             <div class="flex gap-2 overflow-x-auto hide-scrollbar max-w-full pb-2">
                                ${currentProjectImages.map((img, index) => `
                                    <div onclick="changeMainImage('${img}', ${index})" class="thumbnail-item w-16 h-12 md:w-24 md:h-16 flex-shrink-0 cursor-pointer border border-transparent hover:border-white/50 transition-all ${index === 0 ? 'border-yr-red opacity-100' : 'opacity-60 hover:opacity-100'}">
                                        <img src="${img}" class="w-full h-full object-cover">
                                    </div>
                                `).join('')}
                             </div>
                        </div>
                    </div>
                    <div class="w-full px-[4vw] flex flex-col md:flex-row gap-[5vh] md:gap-[5vw]">
                        <div class="w-full md:w-1/3 border-t border-gray-200 pt-4 md:sticky md:top-[100px] self-start">
                            <ul class="space-y-4 text-fluid-sm font-light tracking-wide text-gray-600">
                                <li><span class="block text-xs text-gray-400 uppercase tracking-widest mb-1">Project</span>${project.title}</li>
                                <li><span class="block text-xs text-gray-400 uppercase tracking-widest mb-1">Type</span>${project.type}</li>
                                <li><span class="block text-xs text-gray-400 uppercase tracking-widest mb-1">Location</span>${project.location}</li>
                                <li><span class="block text-xs text-gray-400 uppercase tracking-widest mb-1">Year</span>${project.year}</li>
                                <li><span class="block text-xs text-gray-400 uppercase tracking-widest mb-1">Design By</span>${project.designBy}</li>
                                <li><span class="block text-xs text-gray-400 uppercase tracking-widest mb-1">Photography</span>${project.photography}</li>
                            </ul>
                        </div>
                        <div class="w-full md:w-2/3"><div class="prose prose-lg max-w-none text-yr-black font-light tracking-wide leading-loose">${project.description}</div></div>
                    </div>
                `;
                document.getElementById('project-detail-overlay').classList.add('open');
                transOverlay.classList.remove('active');
                setTimeout(() => transOverlay.classList.remove('trans-anim-active'), 500);
            }, 2000);
        };

        window.closeProjectDetail = () => document.getElementById('project-detail-overlay').classList.remove('open');

        window.changeMainImage = (src, index) => {
            const mainImg = document.getElementById('detail-main-image');
            mainImg.classList.add('opacity-0');
            setTimeout(() => { mainImg.src = src; mainImg.classList.remove('opacity-0'); }, 200);
            document.getElementById('image-counter').innerText = index + 1;
            document.querySelectorAll('.thumbnail-item').forEach((thumb, i) => {
                thumb.className = `thumbnail-item w-16 h-12 md:w-24 md:h-16 flex-shrink-0 cursor-pointer border border-transparent hover:border-white/50 transition-all ${i === index ? 'border-yr-red opacity-100' : 'opacity-60 hover:opacity-100'}`;
            });
        };

        // --- ADMIN LOGIC ---
        window.openAdminLogin = () => document.getElementById('login-modal').classList.add('active');
        window.closeAdminLogin = () => document.getElementById('login-modal').classList.remove('active');
        
        window.attemptLogin = () => {
            const id = document.getElementById('admin-id').value;
            const pw = document.getElementById('admin-pw').value;
            if(id === 'bala0105' && pw === 'bala0105') {
                closeAdminLogin();
                openAdminDashboard();
            } else {
                alert("Authentication Failed");
            }
        };

        window.openAdminDashboard = () => {
            document.getElementById('admin-dashboard').classList.add('open');
            refreshAdminProjects();
            refreshAdminTexts();
        };
        window.closeAdminDashboard = () => document.getElementById('admin-dashboard').classList.remove('open');

        window.switchAdminTab = (tab) => {
            document.querySelectorAll('.dashboard-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(`tab-${tab}`).classList.add('active');
            document.getElementById('panel-projects').classList.add('hidden');
            document.getElementById('panel-texts').classList.add('hidden');
            document.getElementById(`panel-${tab}`).classList.remove('hidden');
        };

        window.refreshAdminProjects = () => {
            const list = document.getElementById('admin-projects-list');
            const data = window.projectsData || [];
            list.innerHTML = data.map(p => `
                <div class="bg-white p-4 border border-gray-200 flex gap-4 shadow-sm">
                    <div class="w-20 h-20 bg-gray-100 flex-shrink-0"><img src="${p.image}" class="w-full h-full object-cover"></div>
                    <div class="flex-1">
                        <div class="font-bold text-sm">${p.title}</div>
                        <div class="text-xs text-gray-500">${p.tag}</div>
                        <div class="mt-2 flex gap-2">
                            <button onclick="editProject('${p.id}')" class="text-xs bg-gray-200 px-2 py-1 hover:bg-gray-300">EDIT</button>
                            <button onclick="deleteProject('${p.id}')" class="text-xs bg-red-100 text-red-500 px-2 py-1 hover:bg-red-200">DELETE</button>
                        </div>
                    </div>
                </div>
            `).join('');
        };

        window.refreshAdminTexts = () => {
             const list = document.getElementById('admin-texts-list');
             const texts = window.siteTexts || {};
             // Define editable keys
             const keys = ["hero-title-cn", "hero-subtitle-cn", "hero-desc-cn", "philo-title-cn", "philo-subtitle-cn", "philo-text-1-cn", "philo-text-2-cn"];
             
             list.innerHTML = keys.map(key => `
                <div class="bg-white p-4 border border-gray-200 shadow-sm">
                    <div class="text-xs text-gray-400 font-bold mb-2 uppercase">${key}</div>
                    <textarea id="txt-input-${key}" class="w-full border border-gray-300 p-2 text-sm h-24">${texts[key] || ''}</textarea>
                    <button onclick="saveSiteText('${key}', document.getElementById('txt-input-${key}').value)" class="mt-2 bg-yr-black text-white text-xs px-4 py-2 tracking-widest hover:bg-yr-red">UPDATE</button>
                </div>
             `).join('');
        };

        // Edit Logic
        window.addNewProject = () => {
            document.getElementById('edit-modal-title').innerText = "NEW PROJECT";
            document.getElementById('edit-p-id').value = Date.now().toString(); // Simple ID gen
            // Clear inputs
            ['title','type','location','year','design','photo','tag','image','images','desc'].forEach(id => document.getElementById(`edit-p-${id}`).value = '');
            document.getElementById('edit-p-coming').checked = false;
            document.getElementById('edit-project-modal').classList.add('active');
        };

        window.editProject = (id) => {
            const p = window.projectsData.find(x => x.id == id);
            if(!p) return;
            document.getElementById('edit-modal-title').innerText = "EDIT PROJECT";
            document.getElementById('edit-p-id').value = p.id;
            document.getElementById('edit-p-title').value = p.title;
            document.getElementById('edit-p-type').value = p.type;
            document.getElementById('edit-p-location').value = p.location || '';
            document.getElementById('edit-p-year').value = p.year || '';
            document.getElementById('edit-p-design').value = p.designBy || '';
            document.getElementById('edit-p-photo').value = p.photography || '';
            document.getElementById('edit-p-tag').value = p.tag || '';
            document.getElementById('edit-p-image').value = p.image || '';
            document.getElementById('edit-p-images').value = (p.images || []).join(',');
            document.getElementById('edit-p-desc').value = p.description || '';
            document.getElementById('edit-p-coming').checked = !!p.isComingSoon;
            document.getElementById('edit-project-modal').classList.add('active');
        };

        window.submitProjectEdit = () => {
            const id = document.getElementById('edit-p-id').value;
            const project = {
                id: id,
                title: document.getElementById('edit-p-title').value,
                type: document.getElementById('edit-p-type').value,
                location: document.getElementById('edit-p-location').value,
                year: document.getElementById('edit-p-year').value,
                designBy: document.getElementById('edit-p-design').value,
                photography: document.getElementById('edit-p-photo').value,
                tag: document.getElementById('edit-p-tag').value,
                image: document.getElementById('edit-p-image').value,
                images: document.getElementById('edit-p-images').value.split(',').filter(x => x.trim() !== ''),
                description: document.getElementById('edit-p-desc').value,
                isComingSoon: document.getElementById('edit-p-coming').checked
            };
            window.saveProject(project);
            closeEditModal();
        };

        window.closeEditModal = () => document.getElementById('edit-project-modal').classList.remove('active');

        // Initial Render Trigger
        if(window.initialProjects) window.renderFrontendProjects(window.initialProjects);
    </script>
</body>
</html>